<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        <link rel="canonical" href="http://developer.pardot.com/kb/api-version-4/">
        <link rel="shortcut icon" href="../../favicon.ico">
        

        <title>Version 4 - Pardot API Documentation</title>

        <link href="../../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../../css/font-awesome-4.0.3.css" rel="stylesheet">
        <link href="../../css/prettify-1.0.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">

        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

        
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>

            <!-- Main title -->
            <a class="navbar-brand" href="../..">Pardot API Documentation</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            <!-- Main navigation -->
            <ul class="nav navbar-nav">
            
            
                
                    <li >
                        <a href="../..">Overview</a>
                    </li>
                
            
            
            
                
                    <li class="dropdown active">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">API <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            <li class="active">
                                <a href="./">Version 4</a>
                            </li>
                        
                            <li >
                                <a href="../object-field-references/">Object Field References</a>
                            </li>
                        
                            <li >
                                <a href="../error-codes-messages/">Error Codes & Messages</a>
                            </li>
                        
                            <li >
                                <a href="../bulk-data-pull/">Bulk Data Pull</a>
                            </li>
                        
                        </ul>
                    </li>
                
            
            
            
            
            
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Version 3 <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            <li >
                                <a href="../api-version-3/accounts/">Accounts</a>
                            </li>
                        
                            <li >
                                <a href="../api-version-3/campaigns/">Campaigns</a>
                            </li>
                        
                            <li >
                                <a href="../api-version-3/custom-fields/">Custom Fields</a>
                            </li>
                        
                            <li >
                                <a href="../api-version-3/custom-redirects/">Custom Redirects</a>
                            </li>
                        
                            <li >
                                <a href="../api-version-3/dynamic-content/">Dynamic Content</a>
                            </li>
                        
                            <li >
                                <a href="../api-version-3/emails/">Email</a>
                            </li>
                        
                            <li >
                                <a href="../api-version-3/batch-email-clicks/">Email Clicks</a>
                            </li>
                        
                            <li >
                                <a href="../api-version-3/email-templates/">Email Templates</a>
                            </li>
                        
                            <li >
                                <a href="../api-version-3/forms/">Forms</a>
                            </li>
                        
                            <li >
                                <a href="../api-version-3/lifecycle-histories/">Lifecycle Histories</a>
                            </li>
                        
                            <li >
                                <a href="../api-version-3/lifecycle-stages/">Lifecycle Stages</a>
                            </li>
                        
                            <li >
                                <a href="../api-version-3/lists/">Lists</a>
                            </li>
                        
                            <li >
                                <a href="../api-version-3/list-memberships/">List Memberships</a>
                            </li>
                        
                            <li >
                                <a href="../api-version-3/opportunities/">Opportunities</a>
                            </li>
                        
                            <li >
                                <a href="../api-version-3/prospects/">Prospects</a>
                            </li>
                        
                            <li >
                                <a href="../api-version-3/prospect-accounts/">Prospect Accounts</a>
                            </li>
                        
                            <li >
                                <a href="../api-version-3/tags/">Tags</a>
                            </li>
                        
                            <li >
                                <a href="../api-version-3/tag-objects/">TagObjects</a>
                            </li>
                        
                            <li >
                                <a href="../api-version-3/users/">Users</a>
                            </li>
                        
                            <li >
                                <a href="../api-version-3/visitors/">Visitors</a>
                            </li>
                        
                            <li >
                                <a href="../api-version-3/visitor-activities/">Visitor Activities</a>
                            </li>
                        
                            <li >
                                <a href="../api-version-3/visits/">Visits</a>
                            </li>
                        
                        </ul>
                    </li>
                
            
            
            
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Version 4 <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            <li >
                                <a href="accounts/">Accounts</a>
                            </li>
                        
                            <li >
                                <a href="campaigns/">Campaigns</a>
                            </li>
                        
                            <li >
                                <a href="custom-fields/">Custom Fields</a>
                            </li>
                        
                            <li >
                                <a href="custom-redirects/">Custom Redirects</a>
                            </li>
                        
                            <li >
                                <a href="dynamic-content/">Dynamic Content</a>
                            </li>
                        
                            <li >
                                <a href="emails/">Email</a>
                            </li>
                        
                            <li >
                                <a href="batch-email-clicks/">Email Clicks</a>
                            </li>
                        
                            <li >
                                <a href="email-templates/">Email Templates</a>
                            </li>
                        
                            <li >
                                <a href="forms/">Forms</a>
                            </li>
                        
                            <li >
                                <a href="lifecycle-histories/">Lifecycle Histories</a>
                            </li>
                        
                            <li >
                                <a href="lifecycle-stages/">Lifecycle Stages</a>
                            </li>
                        
                            <li >
                                <a href="lists/">Lists</a>
                            </li>
                        
                            <li >
                                <a href="list-memberships/">List Memberships</a>
                            </li>
                        
                            <li >
                                <a href="opportunities/">Opportunities</a>
                            </li>
                        
                            <li >
                                <a href="prospects/">Prospects</a>
                            </li>
                        
                            <li >
                                <a href="prospect-accounts/">Prospect Accounts</a>
                            </li>
                        
                            <li >
                                <a href="tags/">Tags</a>
                            </li>
                        
                            <li >
                                <a href="tag-objects/">TagObjects</a>
                            </li>
                        
                            <li >
                                <a href="users/">Users</a>
                            </li>
                        
                            <li >
                                <a href="visitors/">Visitors</a>
                            </li>
                        
                            <li >
                                <a href="visitor-activities/">Visitor Activities</a>
                            </li>
                        
                            <li >
                                <a href="visits/">Visits</a>
                            </li>
                        
                        </ul>
                    </li>
                
            
            
            </ul>

            <!-- Search, Navigation and Repo links -->
            <ul class="nav navbar-nav navbar-right">
                
                
                <li>
                    <a rel="next" href="../..">
                    <i class="fa fa-arrow-left"></i> Overview
                    </a>
                </li>
                
                
                <li>
                    <a rel="prev" href="../object-field-references/">
                    Object Field References <i class="fa fa-arrow-right"></i>
                    </a>
                </li>
                
                
                <li>
                    <a href="https://github.com/Pardot/api-docs" target="_blank">
                        
                            <i class="fa fa-github"></i>
                        
                        GitHub
                    </a>
                </li>
                
            </ul>
        </div>
    </div>
</div>

        <div class="container">
            <div class="col-md-3"><div class="bs-sidebar hidden-print well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="main active"><a href="#what-is-version-4">What is Version 4?</a></li>
        
    
        <li class="main "><a href="#transitioning-from-version-3-to-version-4">Transitioning from version 3 to version 4</a></li>
        
            <li><a href="#determining-when-these-changes-are-applicable">Determining when these changes are applicable</a></li>
        
            <li><a href="#request-path-changes">Request Path Changes</a></li>
        
            <li><a href="#prospect-api-changes">Prospect API changes</a></li>
        
            <li><a href="#opportunity-api-changes">Opportunity API changes</a></li>
        
            <li><a href="#visitor-api-changes">Visitor API changes</a></li>
        
    
    </ul>
</div></div>
            <div class="col-md-9 main-content" role="main">




<h1 id="what-is-version-4">What is Version 4?</h1>
<p>In order to accommodate multiple prospects with the same email address,
we have created a new version of our APIs - version 4.
If your Pardot org has this feature enabled now, then you must use version 4. 
If your Pardot org does not have this featured enabled, you must use version 3.</p>
<p>To determine if your Pardot org has this feature enabled, <a href="http://help.pardot.com/customer/portal/articles/2461386-how-can-i-find-out-if-my-account-allows-multiple-prospects-with-the-same-email-address-">check out this guide.</a></p>
<p>For more information on the API in general, check out the <a href="../../">Overview Page</a>.</p>
<p>For specific API endpoints, please select from the "Version 4" list above.</p>
<h1 id="transitioning-from-version-3-to-version-4">Transitioning from version 3 to version 4</h1>
<p>If you are going to
<a href="http://help.pardot.com/customer/portal/articles/2518686-enabling-multiple-prospects-with-the-same-email-address">upgrade your Pardot org to allow multiple prospects with the same email address,</a>
and you use the api, you will need to follow the guidelines below.</p>
<h2 id="determining-when-these-changes-are-applicable">Determining when these changes are applicable</h2>
<p>As soon your Pardot org is upgraded to allow multiple prospects with the same email address, your current API session will be cleared and you must log in again.
Upon logging in, a new field will be returned in the login response. 
This will be your indication that you may no longer use version 3 (or any other previous version), and must now use the version 4 syntax.
Here's what that will look like:</p>
<p>Request:</p>
<pre><code>POST: https://pi.pardot.com/api/login/version/3
message body: email=&lt;email&gt;&amp;password=&lt;password&gt;&amp;user_key=&lt;user_key&gt;
</code></pre>

<p>Response (Before transition):</p>
<pre><code>&lt;rsp stat=&quot;ok&quot; version=&quot;1.0&quot;&gt;
  &lt;api_key&gt;1234abcd&lt;/api_key&gt;
&lt;/rsp&gt;
</code></pre>

<p>Response (After transition):</p>
<pre><code>&lt;rsp stat=&quot;ok&quot; version=&quot;1.0&quot;&gt;
  &lt;api_key&gt;5678qwertyuiop&lt;/api_key&gt;
  &lt;version&gt;4&lt;/version&gt;
&lt;/rsp&gt;
</code></pre>

<p><em>Note: Using version 3 to login will continue to work, even though all other endpoints will require version 4</em></p>
<h2 id="request-path-changes">Request Path Changes</h2>
<p>You will need to modify your request to use the <code>/version/4</code> path. For example:</p>
<p>Before transition:</p>
<pre><code>GET: https://pi.pardot.com/api/prospect/version/3/read/id/1
</code></pre>

<p>After transition:</p>
<pre><code>GET: https://pi.pardot.com/api/prospect/version/4/read/id/1
</code></pre>

<h2 id="prospect-api-changes">Prospect API changes</h2>
<p>Most of the changes in version 4 occur around the prospect APIs. 
When you begin using the version 4 APIs, your logic should know about these changes (<a href="../../kb/api-version-4/prospects">full documentation can be found here</a>)</p>
<ul>
<li><strong>New reference field:</strong>  Prospects can now be referenced using the Salesforce CRM Identifier, known to the api as the <code>fid</code> field.
This <code>fid</code> field refers to the id of the Lead or Contact record in Salesforce. 
You can find the lead id (begins with 00Q) or the contact id (begins with 003) in the URL when viewing a lead or contact as seen below. 
Or, you can get multiple contacts or lead ids from Salesforce using the export tool.
<img src="/img/lead_identifier_example.png" width="100%"></li>
<li><strong>Create:</strong> Prospects can still be created with a referenced <code>email</code> address.
If you call the create api with the same email address multiple times, each call will create a new prospect.
Previously, you would get an error.</li>
<li><strong>Read:</strong> When making a read query, querying by <code>email</code> will return all prospects that share that email address.
Querying by Pardot <code>id</code> or Salesforce <code>fid</code> will only return the one matching prospect.</li>
<li><strong>Update:</strong> Prospects can no longer be updated when referenced via <code>email</code> alone. 
This is because there may now be multiple prospects with the same email address.
Instead, you must use either the Pardot <code>id</code> or Salesforce <code>fid</code> references.</li>
<li><strong>Upsert:</strong> Upsert query by <code>email</code> will <em>always</em> create a new prospect.
Upsert by Pardot <code>id</code> or Salesforce <code>fid</code> will update or create as needed.
See <a href="../../kb/api-version-4/prospects/#upserting-prospects">Upserting Prospects</a> for more details.</li>
<li><strong>Delete:</strong> Delete query must reference by Pardot <code>id</code> or Salesforce <code>fid</code>.</li>
<li><strong>Batch processing:</strong>  Examples of batch processing can be found <a href="../../kb/api-version-4/prospects/#endpoints-for-batch-processing">here</a></li>
</ul>
<h2 id="opportunity-api-changes">Opportunity API changes</h2>
<p><a href="../../kb/api-version-4/opportunities/">Full documentation can be found here.</a></p>
<ul>
<li><strong>Create:</strong> Creating an opportunity using a <code>prospect_email</code> reference must correspond to an existing prospect.
If there are multiple prospects with that email address, the prospect with the most recent activity date will be used.
If you want to apply the opportunity to a specific prospect, then you must reference the prospect using <code>prospect_id</code>.</li>
<li><strong>Query:</strong> If you query using a <code>prospect_email</code> reference, you will receive opportunities that correspond with any prospects that share that email address.
if you want a specific prospect then query by the <code>prospect_id</code>.</li>
</ul>
<h2 id="visitor-api-changes">Visitor API changes</h2>
<p><a href="../../kb/api-version-4/visitors/">Full documentation can be found here.</a></p>
<ul>
<li><strong>Assign:</strong> Assigning by <code>prospect_email</code> alone (no <code>prospect_id</code>) will return an error.</li>
</ul></div>
        </div>

        

        <script src="https://code.jquery.com/jquery-1.10.2.min.js"></script>
        <script src="../../js/bootstrap-3.0.3.min.js"></script>
        <script src="../../js/prettify-1.0.min.js"></script>
        <script src="../../js/base.js"></script>
    </body>
</html>